[2009-1-15 16:06:38] 王岩 说： 5)添加脚本发送KickoutCustomerInfo消息,这个脚本的内容要根据提供的CUSTOMER_ID发送
KickoutCustomerInfo消息。

注意，因为这个消息需要的是sessionId,所以在拿到customerId后需要通过下面sql查询出
sessionId，添加到这个消息中发出：
SELECT SESSION_ID FROM JHF_CUSTOMER_SESSION WHERE CUSTOMER_ID = ?
当根据customerId找不到SessionId时，则不需要发送消息。
->老卢
[2009-1-15 16:06:47] 王岩 说： EM 0维护那个课题,需要写个脚本.










[jhfapp@middle2 bin]$ ./runKickOutCustomer.sh 90000007
[1] 9600
[jhfapp@middle2 bin]$ 
===============================================
=== Kick Out Customer Session Begin ... ====
===============================================
ClearCache has been started for main.cfg.xml
===[KickOutCustomerSession]=== session id list size :32  customer:90000007
sessionId:65602AC9E74B425A8B4F60B25EBC84D0,customerId:90000007
sessionId:BCA44D8E1A475B010D2E547543A32D7E,customerId:90000007
sessionId:B537222FA728F1C9B484546A69AAAD83,customerId:90000007
sessionId:E8E74CCE6C0F06E405C882565915EC46,customerId:90000007
sessionId:163FD13B01BE8C25C028D392E20D7092,customerId:90000007
sessionId:0BA7C8A5D898C1B8E35A7B4083E5BDE5,customerId:90000007
sessionId:3DE76BA19A2BC05919898034A0A497FC,customerId:90000007
sessionId:684DC0556C203D00E2715188ECB4AC8C,customerId:90000007
sessionId:1568BA0F85B7C9B0CD5D8825993A4556,customerId:90000007
sessionId:76C33A3E88A78258F7AF6081AEE82105,customerId:90000007
sessionId:585A984EB59158819FC75C0A8C192871,customerId:90000007
sessionId:4729887644B1BA24289B12D3C340ADDA,customerId:90000007
sessionId:6C2530B90F9AAE6DA08201AD12DD4B4D,customerId:90000007
sessionId:D5FAFF484BDCF5BE99D7A662CBAC1DCC,customerId:90000007
sessionId:1467625992836367882,customerId:90000007
sessionId:4693444730417630517,customerId:90000007
sessionId:493E87FE47174C0917AB6CB4F0D4348D,customerId:90000007
sessionId:7205395442451073478,customerId:90000007
sessionId:1374491000506764501,customerId:90000007
sessionId:5103538944182968857,customerId:90000007
sessionId:8745796163381413411,customerId:90000007
sessionId:1746066053795252640,customerId:90000007
sessionId:7381307222410765383,customerId:90000007
sessionId:757258851263236822,customerId:90000007
sessionId:587464504005184893,customerId:90000007
sessionId:6502951038760971424,customerId:90000007
sessionId:3022989627652243637,customerId:90000007
sessionId:DCD280FEDB210F8BAEEE19760818CA9B,customerId:90000007
sessionId:2A8DB1AE3596BC9ED262B05A7EC8791F,customerId:90000007
sessionId:686ED85B125A5087E14AC37644A7BFF5,customerId:90000007
sessionId:7B3BE6ED6F1E8B1AFBADF7A2348E8B18,customerId:90000007
sessionId:C3E552DADDB3C7F78F6B83BD67C1839B,customerId:90000007
===[KickOutCustomerSession]=== Send KickoutCustomerInfo:cn.bestwiz.jhf.core.jms.bean.KickoutCustomerInfo@c2060e[sessionIds=[65602AC9E74B425A8B4F60B25EBC84D0, BCA44D8E1A475B010D2E547543A32D7E, B537222FA728F1C9B484546A69AAAD83, E8E74CCE6C0F06E405C882565915EC46, 163FD13B01BE8C25C028D392E20D7092, 0BA7C8A5D898C1B8E35A7B4083E5BDE5, 3DE76BA19A2BC05919898034A0A497FC, 684DC0556C203D00E2715188ECB4AC8C, 1568BA0F85B7C9B0CD5D8825993A4556, 76C33A3E88A78258F7AF6081AEE82105, 585A984EB59158819FC75C0A8C192871, 4729887644B1BA24289B12D3C340ADDA, 6C2530B90F9AAE6DA08201AD12DD4B4D, D5FAFF484BDCF5BE99D7A662CBAC1DCC, 1467625992836367882, 4693444730417630517, 493E87FE47174C0917AB6CB4F0D4348D, 7205395442451073478, 1374491000506764501, 5103538944182968857, 8745796163381413411, 1746066053795252640, 7381307222410765383, 757258851263236822, 587464504005184893, 6502951038760971424, 3022989627652243637, DCD280FEDB210F8BAEEE19760818CA9B, 2A8DB1AE3596BC9ED262B05A7EC8791F, 686ED85B125A5087E14AC37644A7BFF5, 7B3BE6ED6F1E8B1AFBADF7A2348E8B18, C3E552DADDB3C7F78F6B83BD67C1839B]]
===============================================
=== Kick Out Customer Session Succeed ! ====
===============================================







DB  DATA



SELECT  SESSION_ID ,CUSTOMER_ID FROM JHF_CUSTOMER_SESSION WHERE CUSTOMER_ID = '90000007'





 SESSION_ID                        CUSTOMER_ID    
 --------------------------------  -------------- 
 65602AC9E74B425A8B4F60B25EBC84D0  90000007       
 BCA44D8E1A475B010D2E547543A32D7E  90000007       
 B537222FA728F1C9B484546A69AAAD83  90000007       
 E8E74CCE6C0F06E405C882565915EC46  90000007       
 163FD13B01BE8C25C028D392E20D7092  90000007       
 0BA7C8A5D898C1B8E35A7B4083E5BDE5  90000007       
 3DE76BA19A2BC05919898034A0A497FC  90000007       
 684DC0556C203D00E2715188ECB4AC8C  90000007       
 1568BA0F85B7C9B0CD5D8825993A4556  90000007       
 76C33A3E88A78258F7AF6081AEE82105  90000007       
 585A984EB59158819FC75C0A8C192871  90000007       
 4729887644B1BA24289B12D3C340ADDA  90000007       
 6C2530B90F9AAE6DA08201AD12DD4B4D  90000007       
 D5FAFF484BDCF5BE99D7A662CBAC1DCC  90000007       
 1467625992836367882               90000007       
 4693444730417630517               90000007       
 493E87FE47174C0917AB6CB4F0D4348D  90000007       
 7205395442451073478               90000007       
 1374491000506764501               90000007       
 5103538944182968857               90000007       
 8745796163381413411               90000007       
 1746066053795252640               90000007       
 7381307222410765383               90000007       
 757258851263236822                90000007       
 587464504005184893                90000007       
 6502951038760971424               90000007       
 3022989627652243637               90000007       
 DCD280FEDB210F8BAEEE19760818CA9B  90000007       
 2A8DB1AE3596BC9ED262B05A7EC8791F  90000007       
 686ED85B125A5087E14AC37644A7BFF5  90000007       
 7B3BE6ED6F1E8B1AFBADF7A2348E8B18  90000007       
 C3E552DADDB3C7F78F6B83BD67C1839B  90000007       

 32 record(s) selected [Fetch MetaData: 16/ms] [Fetch Data: 0/ms] 

 [Executed: 09-2-4 下午03时11分31秒 ] [Execution: 16/ms] S

















[jhfapp@middle2 bin]$ cat runKickOutCustomer.sh 
#
# run process script for RateManager
#   created by Roger
#---------------------------------------------------------------------------
if [ "$OS" = "Windows_NT" ]; then
        ARGS=""
else
        MIN_MEMORY=64m
        MAX_MEMORY=64m
        MIN_NEW_SIZE=8m
        MAX_NEW_SIZE=8m
#        ARGS="-Xms${MIN_MEMORY} -Xmx${MAX_MEMORY} -XX:NewSize=${MIN_NEW_SIZE} -XX:MaxNewSize=${MAX_NEW_SIZE}"
ARGS="-Xms${MIN_MEMORY} -Xmx${MAX_MEMORY} -XX:NewSize=${MIN_NEW_SIZE} -XX:MaxNewSize=${MAX_NEW_SIZE} -Xss1m -XX:+UseConcMarkSweepGC -XX:CMSFullGCsBeforeCompaction=5 -XX:+UseCMSCompactAtFullCollection"
fi

tcsh -c "java -DPROCESS_NAME=KickOutCustomer -DconfigPath=/jhfapp/app/trader/trader/conf/ ${ARGS} cn.bestwiz.jhf.core.tools.KickOutCustomerSession $*&"