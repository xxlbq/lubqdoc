




Panta All 185,表分解的课题,很多Table都进行表名字的改动,分解成Alive和Finished和History.
程序中就是改成使用Alive就可以了.

【1】JHF_EXECUTION->JHF_ALIVE_EXECUTION,JHF_FINISHED_EXECUTION------>老卢     JhfExecution
 Trader进行对顾客约定的时候,需要改成使用JHF_ALIVE_EXECUTION

【2】JHF_CONTRACT_BIND->JHF_ALIVE_CONTRACT_BIND,JHF_FINISHED_CONTRACT_BIND------>老卢     JhfContractBind
 Trader对顾客进行决计持仓约定的时候,需要改成使用JHF_ALIVE_CONTRACT_BIND

【3】JHF_CP_EXECUTION->JHF_ALIVE_CP_EXECUTION,JHF_FINISHED_CP_EXECUTION------>王宁/小候     JhfCpExecution
 Hedger,DLHedger进行CP约定的时候,需要改成使用JHF_ALIVE_CP_EXECUTION

【4】JHF_CP_CASHFLOW->JHF_ALIVE_CP_CASHFLOW,JHF_FINISHED_CP_CASHFLOW------>王宁/小候    JhfCpCashflow
 DLHedger,DLHedger进行CP约定的时候,需要改成使用JHF_ALIVE_CP_CASHFLOW

【5】JHF_EXECUTION_BIND->JHF_ALIVE_EXECUTION_BIND,JHF_FINISHED_EXECUTION_BIND------>老卢/王宁/小候  JhfExecutionBind
 Trader和Hedger,DLHedger进行CP约定的时候,需要改成使用JHF_ALIVE_EXECUTION_BIND

【6】JHF_CP_TRADE_REQUEST->JHF_ALIVE_CP_TRADE_REQUEST,JHF_FINISHED_CP_TRADE_REQUEST------>王宁/小候  JhfCpTradeRequest
 Hedger,DLHedger记录发送给CP的Request信息的时候,需要改成使用JHF_ALIVE_CP_TRADE_REQUEST

【7】JHF_CP_TRADE_RESPONSE->JHF_ALIVE_CP_TRADE_RESPONSE,JHF_FINISHED_CP_TRADE_RESPONSE------>王宁/小候   
JhfCpTradeResponse
 Hedger,DLHedger记录发送给CP的Request信息的时候,需要改成使用JHF_ALIVE_CP_TRADE_RESPONSE

【8】JHF_NETTED_EXECUTION->JHF_ALIVE_NETTED_EXECUTION,JHF_FINISHED_NETTED_EXECUTION------>王宁/小候    JhfNettedExecution
 Hedger,DLHedger进行CP约定的时候,需要改成使用JHF_ALIVE_NETTED_EXECUTION

【9】JHF_DL_EXECUTION_BIND->JHF_ALIVE_DL_EXECUTION_BIND,JHF_FINISHED_DL_EXECUTION_BIND------>王宁/小候   
JhfDlExecutionBind
 DLHedger进行CP约定的时候,需要改成使用JHF_ALIVE_DL_EXECUTION_BIND

【10】JHF_DL_ORDER->JHF_ALIVE_DL_ORDER,JHF_FINISHED_DL_ORDER------>小候/江一山       JhfDlOrder
 DLHedger,DLEWP,DLOPM,进行CP约定的时候,需要改成使用JHF_ALIVE_DL_ORDER
请在Panta Head上进行以上的调整
















tradedao 

	@SuppressWarnings("unchecked")
	public List getExecutions(GetExecutionsParams params, MaxCount maxCount) throws DaoException {
		log.debug("getExecutions(GetExecutionsParams params)  function start");
		List rows = null;
		List<Criterion> lstCriterion = new ArrayList<Criterion>();
		try {
			Object[] productIds = null;
			if (params.getLeverageLevelId() != null) {
				productIds = DAOFactory.getConfigDao()
						.getProductIdsByLeverageLevelId(
								params.getLeverageLevelId());
			}
			StringBuffer sb = new StringBuffer();
			sb.append("FROM JhfExecution as fe where ");





	@SuppressWarnings("unchecked")
	public List getExecuvionInfo(JhfAliveExecution executionInfo,String todate)
		throws DaoException
	{
		Query query = null;
		List list=null;
		//check input
		try {
			if(executionInfo == null){
				throw new DaoException("The ExecutionInfo object is null");
			}
			BigDecimal side = executionInfo.getSide();
			String fromDate = executionInfo.getExecutionDate();
			String pair = executionInfo.getCurrencyPair();
			StringBuffer sbHql = new StringBuffer();
			sbHql.append(" FROM  ");
			sbHql.append(" JhfExecution  as jhf ");
			sbHql.append(" WHERE  ");
			sbHql.append(" jhf.executionDate>= ?");
			sbHql.append(" and jhf.executionDate<= ?");
			if(!"0".equals(pair)){
				sbHql.append(" and jhf.currencyPair = ? ");


	/**
	 * @TODO method  get JhfCpExecution according to the cpCoverId
	 * @param cpCoverId
	 * @return
	 * @throws DaoException
	 * @author liuxt <liuxt@bestwiz.cn>
	 */
	public JhfAliveCpExecution obtainCpExecution(String cpCoverId) throws DaoException {
		Object object =null;
        String HQL = "FROM JhfCpExecution AS jhf WHERE jhf.cpCoverId=? And activeFlag = ?";
        try
        {
            Query query = getSession().createQuery(HQL);
            query.setString(0, cpCoverId);
            query.setBigDecimal(1, new BigDecimal(BoolEnum.BOOL_YES_ENUM.getValue()));
            object =query.uniqueResult();
        }
        catch (HibernateException e)
        {
            m_log.error("======== TradeDao.obtainCpExecution Error! cpCoverId:"+cpCoverId, e);
            throw new DaoException(e);
        }






CpCashflowDao

   /**
     * 根据cpCoverId检索cpExecution
     * 
     * @param cpCoverId
     * @return
     * @throws DaoException
     * @author mengfj 2006/11/25
     */
    @SuppressWarnings("unchecked")
    public List<JhfAliveCpExecution> getCpExecutiongByCpCoverId(String cpCoverId)
            throws DaoException
    {
        List<JhfAliveCpExecution> list = null;
        String HQL = "FROM JhfCpExecution AS jhf WHERE jhf.cpCoverId=? AND jhf.activeFlag=?";
        try
        {
            Query query = getSession().createQuery(HQL);
            query.setString(0, cpCoverId);
            query.setBigDecimal(1, BigDecimal.valueOf(BoolEnum.BOOL_YES_ENUM
                    .getValue()));
            list = query.list();











    /**
     * CPF金流集功能,根据用户输入的条件,检索jhf_cashflow表符合条件的数据,以List形式返回
     * 
     * @param beginDate
     * @param endDate
     * @param bank
     * @return list
     * @author shaoxia
     * @throws DaoException
     */

    public List viewCpCashFlowList(String beginDate, String endDate, String bank)
            throws DaoException
    {
//        List list = new ArrayList();
        try
        {
            StringBuffer strHQL = new StringBuffer(200);
            strHQL.append(" SELECT sum(cashflowAmount) as cashflowAmount, ");
            strHQL.append(" currencyCode ,realizeDate ");
            strHQL.append(" FROM JhfCpCashflow ");

   /**
     * CP入金情仕鞲据用户在页面输入的条件在jhf_cash_flow表中检索出数据
     * 
     * @param map
     *            存储用户在页面输入的条件
     * @return list
     * @author shaoxia
     * @throws DaoException
     */

    public List viewCpCashFlowInfoList(Map map) throws DaoException
    {
//        List list = new ArrayList();
        int year = 0, month = 0, day = 0;
        Date beginDate, endDate;
        int i = 0;
        try
        {
            StringBuffer strHQL = new StringBuffer(200);
            strHQL.append(" FROM JhfCpCashflow ");
            strHQL.append(" WHERE activeFlag=1 ");
            if (!GenericValidator.isBlankOrNull(map.get("money").toString()))
            {









dlorderdao


	/**
	 * 由JhfDealerOrderBindId 获取 JhfCpExecution
	 * 
	 * @param JhfDealerOrderBindId
	 * @return JhfCpExecution
	 * @throws DaoException
	 * @author huangcm <huangcm@bestwiz.cn>
	 */
	public JhfAliveCpExecution getJhfCpExecution(String JhfDealerOrderBindId)
			throws DaoException {
		String hsql = "FROM JhfCpExecution where dlOrderBindId=:id";

		Query query = getSession().createQuery(hsql);
		query.setParameter("id", JhfDealerOrderBindId);

		if (query.list() == null || query.list().size() == 0) {
			return null;
		} else {
			return (JhfAliveCpExecution) query.list().get(0);
		}

	}





CpTradeDao

    /**
     * @param cpCoverId
     * @return
     * @throws DaoException
     */
    @SuppressWarnings("unchecked")
	public List<JhfAliveCpTradeRequest> getCpTradeRequest (String cpCoverId)
    throws DaoException{
    	
    	
    	
//    	变更 --> 根据cpCoverId(也就是orderbindId)来查询 JhfCpTradeRequest 有可能返回多条记录
//    	return (JhfCpTradeRequest)getSession().get(JhfCpTradeRequest.class, cpCoverId);
    	
    	List<JhfAliveCpTradeRequest> requestList = null;
        StringBuffer HQL = new StringBuffer(200);
        HQL.append("FROM JhfCpTradeRequest AS jhf " +
                		" WHERE jhf.cpCoverId = ? AND jhf.activeFlag = ? " +
                		" ORDER BY jhf.seqNo DESC ");
        try
        {



   /**
     * 根据id查询cpTradeRequest
     * 
     * @param cpCoverId
     * @return
     * @throws DaoException
     */
    public JhfAliveCpTradeRequest getCpTradeRequestById(String cpCoverId)
            throws DaoException
    {
        JhfAliveCpTradeRequest request = null;
        StringBuffer HQL = new StringBuffer(200);
        HQL
                .append("FROM JhfCpTradeRequest AS jhf WHERE jhf.cpCoverId = ? AND jhf.activeFlag = ? ORDER BY seqNo 
DESC");
        try
        {