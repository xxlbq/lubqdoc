SELECT * FROM JHF_WL_CLIENT_CONFIG ;
SELECT * FROM JHF_WL_RATE_CONFIG ;

DELETE FROM JHF_WL_CLIENT_CONFIG WHERE CLIENT_ID = 'WHOAMI' ;
DELETE FROM JHF_WL_RATE_CONFIG WHERE CLIENT_ID = 'WHOAMI' ;

INSERT INTO JHF_WL_CLIENT_CONFIG(CLIENT_ID, CLIENT_NAME, CUSTOMER_ID, FEED_CONSTRAINT, ORDER_CONSTRAINT, ORDER_FREQUENCY, ORDER_FREQUENCY_BUCKET_SIZE, ORDER_EXPIRATION_INTERVAL, TRADABLE_END_INTERVAL, PRICE_EXPIRATION_INTERVAL, EXECUTION_UNKNOWN_INTERVAL, MARGIN_CONSTRAINT, MARGIN_STATUS, CONTRACT_UPPER_AMOUNT_CONSTRAINT, UPDATE_STAFF_ID, INPUT_STAFF_ID, ACTIVE_FLAG, INPUT_DATE, UPDATE_DATE) 
    VALUES('WHOAMI', 'WHOAMI', '66666666', 1, 1, 0, 100,15000, 300000, 15000, 120000, 0, 0, 0, 'SYSTEM', 'SYSTEM', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);


SELECT FAIL_REASON FROM JHF_WL_ORDER WHERE ORDER_STATUS = 2 



---  TradeConstraintValidator
/*
    1. JhfWlClientConfig  EXIST 
    2. orderConstraint = 1 
    3. market open
    4. in rollover time
*/






SELECT * FROM JHF_TRADE_CONSTRAINT;
update JHF_TRADE_CONSTRAINT set MARKET_CLOSE_FLAG = 0 ;
update JHF_TRADE_CONSTRAINT set MARKET_CLOSE_FLAG = 1 ;
update JHF_TRADE_CONSTRAINT set MARKET_CLOSE_FLAG = 2 ;
SELECT * FROM JHF_WL_CLIENT_CONFIG ;


SELECT * FROM JHF_WL_CLIENT_CONFIG WHERE CLIENT_ID = 'WLXXXX' ;
     -- can trader
UPDATE JHF_WL_CLIENT_CONFIG SET ORDER_CONSTRAINT = 1  WHERE CLIENT_ID = 'WLXXXX' ;
     -- not trader
UPDATE JHF_WL_CLIENT_CONFIG SET ORDER_CONSTRAINT = 2  WHERE CLIENT_ID = 'WLXXXX' ;



SELECT FRONT_DATE,FRONT_END_DATETIME FROM JHF_APPLICATION_DATE ;
SELECT * FROM JHF_WL_CLIENT_CONFIG WHERE CLIENT_ID = 'WLXXXX'
UPDATE JHF_APPLICATION_DATE SET FRONT_DATE ='20110112' ,FRONT_END_DATETIME='2011-01-13 06:50:00' WHERE DATE_KEY IN ('F','S');
UPDATE JHF_WL_CLIENT_CONFIG SET TRADABLE_END_INTERVAL = 99999999       WHERE CLIENT_ID = 'WLXXXX' ;
UPDATE JHF_WL_CLIENT_CONFIG SET TRADABLE_END_INTERVAL = 300000  WHERE CLIENT_ID = 'WLXXXX' ;



--- QUERY  WL_ORDER

SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110414WL0000204767' ;

SELECT WL_ORDER_ID,ORDER_PRICE ,EXECUTION_PRICE ,SLIPPAGE FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110414WL0000204771' ;


----  DUPLI   ORDER

SELECT * FROM JHF_WL_ORDER WHERE CLIENT_ID  = 'WLXXXX' AND CLIENT_ORDER_NO = '20110117COVR00470305' ;





---  ExpiredValidator
/*
     1 .JhfWlClientConfig.getOrderExpirationInterval
     

*/
SELECT * FROM JHF_WL_CLIENT_CONFIG where CLIENT_ID = 'WLXXXX'
UPDATE JHF_WL_CLIENT_CONFIG SET ORDER_EXPIRATION_INTERVAL = '999999999' WHERE CLIENT_ID='WHOAMI';
UPDATE JHF_WL_CLIENT_CONFIG SET ORDER_EXPIRATION_INTERVAL = '15000' WHERE CLIENT_ID='WLXXXX';





---  CCY Validator


SELECT * FROM JHF_WL_RATE_CONFIG
SELECT * FROM JHF_WL_RATE_CONFIG WHERE CLIENT_ID = 'WLXXXX' AND FEED_DIV =0 AND ACTIVE_FLAG = 1 AND CURRENCY_PAIR='USD/JPY' ;
UPDATE JHF_WL_RATE_CONFIG SET  FEED_DIV =0 WHERE CLIENT_ID = 'WLXXXX'  ;
UPDATE JHF_WL_RATE_CONFIG SET  FEED_DIV =1 WHERE CLIENT_ID = 'WLXXXX'  ;

UPDATE JHF_WL_RATE_CONFIG SET  ACTIVE_FLAG =1 WHERE CLIENT_ID = 'WLXXXX' AND CURRENCY_PAIR='USD/JPY' ; 

---  RATE VALIDATOR

SELECT PRICE_EXPIRATION_INTERVAL FROM JHF_WL_CLIENT_CONFIG WHERE CLIENT_ID = 'WLXXXX'
   --- 
UPDATE JHF_WL_CLIENT_CONFIG SET PRICE_EXPIRATION_INTERVAL = '0' WHERE CLIENT_ID = 'WLXXXX'
UPDATE JHF_WL_CLIENT_CONFIG SET PRICE_EXPIRATION_INTERVAL = '10' WHERE CLIENT_ID = 'WLXXXX'



SELECT * FROM JHF_WL_CLIENT_CONFIG WHERE CLIENT_ID = 'MINFX'



---  PRICE VALIDATOR 

SELECT * FROM JHF_WL_STATUS_CONTRAL WHERE CURRENCY_PAIR = 'USD/JPY' AND CLIENT_ID = 'WHOAMI' ;
     -- EXECUTION_PRICE_TYPE IN (1,2,3)
UPDATE JHF_WL_STATUS_CONTRAL SET EXECUTION_PRICE_TYPE = 1 WHERE CURRENCY_PAIR = 'USD/JPY' AND CLIENT_ID = 'WLXXXX' ;








SELECT * FROM JHF_WL_ORDER 
--DELETE FROM JHF_WL_ORDER WHERE CLIENT_ID = 'WHOAMI'
SHOW CREATE TABLE JHF_WL_ORDER




----  ==================    QUERY  COMPLETOR ORDERS 

SELECT * FROM JHF_WL_ORDER WHERE COMPLETION_STATUS IN (1,2,4) AND ACTIVE_FLAG = 1 ;

--- INSERT   COMPLETOR ORDERS 




SELECT * from JHF_COUNTERPARTY where COUNTERPARTY_ID = 'WLCM';
SELECT * from JHF_COUNTERPARTY_CURRENCYPAIR where COUNTERPARTY_ID = 'WLCM'




-- PRODUCT 


SELECT * FROM JHF_GROUP_DEFAULT_PRODUCT ;
SELECT GROUP_ID FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID = '00000239';


SELECT PRODUCT_ID FROM  JHF_GROUP_DEFAULT_PRODUCT G,JHF_CUSTOMER_STATUS C 
WHERE G.CURRENCY_PAIR = 'USD/JPY' AND G.GROUP_ID = C.GROUP_ID AND C.CUSTOMER_ID = '00000239'
AND G.ACTIVE_FLAG = 1  AND C.ACTIVE_FLAG = 1


SELECT * FROM JHF_APPLICATION_DATE;
       



---  QUERY ALIVE_ORDER BY WLORDER

SELECT * FROM JHF_ALIVE_ORDER WHERE ORDER_ID IN (
    SELECT ORDER_ID FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = 'TESTWL000002');

SELECT * FROM JHF_ALIVE_ORDER WHERE ORDER_ID IN ();

SELECT * FROM JHF_WL_ORDER WHERE COMPLETION_STATUS IS NULL;
---  QUERY NET RESULT 

SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110112ORD00134002'


SELECT * FROM JHF_WL_ORDER WHERE CUSTOMER_ID = '00000239' ;
SELECT * FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID = '00000239' ;
SELECT * FROM JHF_ALIVE_EXECUTION WHERE CUSTOMER_ID = '00000239' AND ORDER_ID='20101228ORD00132801' ;;
SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '00000239' AND ORDER_ID='20101228ORD00132801' ;
SELECT * FROM JHF_WL_ORDER_BIND ;


SELECT * FROM JHF_HEDGE_CUSTTRADE WHERE ID = '20110113WL0000017304';
SELECT * FROM JHF_SYS_POSITION_INSERT WHERE POSITION_SOURCE_ID = '20110113WL0000017304';

SELECT * FROM JHF_WL_ORDER WHERE CUSTOMER_ID = '00000239' ;
SELECT * FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID = '00000239'AND ORDER_ID='20101228ORD00132402' ; ;
SELECT * FROM JHF_ALIVE_EXECUTION WHERE CUSTOMER_ID = '00000239' AND ORDER_ID='20101228ORD00132402' ;;
SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '00000239' AND ORDER_ID='20101228ORD00132402' ;
SELECT * FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID='TESTWL000005';


SELECT AMOUNT,AMOUNT_NO_SETTLED,AMOUNT_SETTLED,AMOUNT_SETTLING FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '00000239'


SELECT * FROM JHF_WL_ORDER WHERE CLIENT_ORDER_NO = '20110113COVR00468410'


--    >>>>>>>>>>>>     \\\
---   WL  TRADER 

-- FAIL
SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110118WL0000020001'

--- SUCCESS
SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110221WL0000019101'
    --SELECT * FROM JHF_HEDGE_CUSTTRADE WHERE ID =${ WL_ORDER_ID }
SELECT * FROM JHF_HEDGE_CUSTTRADE WHERE ID ='20110119WL0000023202';
    --SELECT * FROM JHF_SYS_POSITION_INSERT WHERE POSITION_SOURCE_ID = ${ WL_ORDER_ID }
SELECT * FROM JHF_SYS_POSITION_INSERT WHERE POSITION_SOURCE_ID = '20110119WL0000023202'

--   <<<<<<<<<<<<<      \\\


SHOW CREATE TABLE JHF_WL_ORDER;
SHOW keys from JHF_WL_ORDER;

UPDATE JHF_WL_ORDER SET CLIENT_ORDER_NO =concat( CLIENT_ORDER_NO,'WRONG') WHERE CLIENT_ORDER_NO = 'MktOrdId1'

SELECT * FROM JHF_WL_STATUS_CONTRAL;
UPDATE JHF_WL_STATUS_CONTRAL SET PRICE_HISTORY_CACHE_SWITCH =1  ;


SELECT * FROM JHF_WL_STATUS_CONTRAL WHERE CLIENT_ID = 'WLXXXX' AND CURRENCY_PAIR = 'USD/JPY';
 
SELECT * FROM JHF_APP_PROPERTY WHERE PROP_TYPE = 'HEDGE';
UPDATE JHF_APP_PROPERTY SET PROPERTY_VALUE = '1' WHERE PROPERTY_KEY= 'PCNewRateRetryNum' ;



---  TRADER     RISK  CONTROL

--SELECT * FROM JHF_WL_ORDER WHERE 

SELECT * FROM JHF_WL_CLIENT_CONFIG WHERE CLIENT_ID = 'WLXXXX' ;
            --   1  , USE ,,  0  NOT USE;
UPDATE JHF_WL_CLIENT_CONFIG  SET CONTRACT_UPPER_AMOUNT_CONSTRAINT =0 WHERE CLIENT_ID = 'WLXXXX' ;

;
SELECT wlorder.WL_ORDER_ID ,wlorder.CLIENT_ID,wlorder.CURRENCY_PAIR,SUM(wlorder.SIDE  * wlorder.ORDER_AMOUNT ) FROM JHF_WL_ORDER wlorder 
 ,

(SELECT wlpos.BASE_DATE,wlpos.CLIENT_ID,wlpos.CURRENCY_PAIR,wlpos.AMOUNT FROM JHF_WL_SYS_POSITION  wlpos WHERE wlpos.BASE_DATE = '20110118') HIS
WHERE wlorder.ORDER_DATE = '20110119' OR (HIS.CLIENT_ID = wlorder.CLIENT_ID AND HIS.CURRENCY_PAIR = wlorder.CURRENCY_PAIR) GROUP BY wlorder.CLIENT_ID ,wlorder.CURRENCY_PAIR

 WL_ORDER_ID           CLIENT_ID     CURRENCY_PAIR     SUM(wlorder.SIDE  * wlorder.ORDER_AMOUNT )    
 --------------------  ------------  ----------------  --------------------------------------------- 
 20110113WL0000017201  WHOAMI        USD/JPY           1800000                                       
 20110117WL0000019801  WLXXXX        EUR/JPY           26660000                                      
 20110113WL0000017082  WLXXXX        USD/JPY           66427000.1                                    



SELECT * FROM JHF_WL_SYS_POSITION 


SELECT wlpos.BASE_DATE,wlpos.CLIENT_ID,wlpos.CURRENCY_PAIR,wlpos.AMOUNT FROM JHF_WL_SYS_POSITION  wlpos WHERE wlpos.BASE_DATE = '20110118'
 BASE_DATE     CLIENT_ID     CURRENCY_PAIR     AMOUNT    
 ------------  ------------  ----------------  --------- 
 20110118      WHOAMI        USD/JPY           500000    
 20110118      WLXXXX        EUR/JPY           25480000  
 20110118      WLXXXX        USD/JPY           35520000  



SELECT wlorder.WL_ORDER_ID ,wlorder.CLIENT_ID,wlorder.CURRENCY_PAIR,SUM(wlorder.SIDE  * wlorder.ORDER_AMOUNT ) FROM JHF_WL_ORDER wlorder 
WHERE wlorder.ORDER_DATE = '20110119' GROUP BY CLIENT_ID,CURRENCY_PAIR

 WL_ORDER_ID           CLIENT_ID     CURRENCY_PAIR     SUM(wlorder.SIDE  * wlorder.ORDER_AMOUNT )    
 --------------------  ------------  ----------------  --------------------------------------------- 
 20110119WL0000020619  WLXXXX        EUR/JPY           70000                                         
 20110119WL0000023138  WLXXXX        USD/JPY           750000           

             
SELECT 25480000 + 70000  
25550000

SELECT * FROM JHF_HEDGE_CUSTTRADE WHERE ID ='20110121WL0000024401'
;
UPDATE JHF_WL_ORDER SET COMPLETION_STATUS = '5' WHERE WL_ORDER_ID = '20110121WL0000024801' ;







  ---------------------@@@@     COMPLETOR    @@@------------------------

-- COMPLETOR VALIDATEOR
-- MAKE CLOSE
SELECT * FROM JHF_TRADE_CONSTRAINT 
update JHF_TRADE_CONSTRAINT set MARKET_CLOSE_FLAG = 0 ;
update JHF_TRADE_CONSTRAINT set MARKET_CLOSE_FLAG = 1 ;
-- BFEFORE ROLLOVER TIME      60 S
SELECT FRONT_END_DATETIME FROM JHF_APPLICATION_DATE WHERE DATE_KEY = 'F' ;

UPDATE JHF_APPLICATION_DATE SET FRONT_END_DATETIME = CURRENT_TIMESTAMP WHERE DATE_KEY = 'F' ;
UPDATE JHF_APPLICATION_DATE SET FRONT_END_DATETIME = '2011-2-15 06:50:00' WHERE DATE_KEY = 'F' ;


 ---  [ NET ]  open
SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110418WL0000205831 ';
SELECT * FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110418WL0000205831';

SELECT * FROM JHF_ALIVE_ORDER WHERE ORDER_ID = (
    SELECT ORDER_ID FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110418WL0000205831');

SELECT * FROM JHF_ALIVE_EXECUTION WHERE ORDER_ID =(
    SELECT ORDER_ID FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110418WL0000205831') ;

SELECT * FROM JHF_ALIVE_CONTRACT WHERE ORDER_ID =(
    SELECT ORDER_ID FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110517WL0000234806') ;


UPDATE JHF_WL_ORDER SET COMPLETION_STATUS = 5 WHERE WL_ORDER_ID = '20110418WL0000205831 ';



 ---  [ NET ]  close

SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110419WL0000206121' ;
SELECT * FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110419WL0000206121';

SELECT * FROM JHF_ALIVE_ORDER WHERE ORDER_ID IN (
    SELECT ORDER_ID FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110418WL0000205832');
--SELECT * FROM JHF_ALIVE_ORDER WHERE ORDER_ID IN ('20110419ORD00179810');

SELECT * FROM JHF_ALIVE_EXECUTION WHERE ORDER_ID IN (
    SELECT ORDER_ID FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110418WL0000205832') ;
--SELECT CONVERT_RATE FROM JHF_ALIVE_EXECUTION WHERE ORDER_ID IN ('20110419ORD00179810') ;

SELECT * FROM JHF_ALIVE_CONTRACT WHERE ORDER_ID IN (
    SELECT TOP_ORDER_ID FROM JHF_ALIVE_ORDER WHERE ORDER_ID IN (
    SELECT ORDER_ID FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110418WL0000205832') );


SELECT * FROM JHF_ALIVE_CONTRACT_BIND WHERE CONTRACT_ID IN (
    SELECT CONTRACT_ID FROM JHF_ALIVE_CONTRACT WHERE ORDER_ID IN (
    SELECT TOP_ORDER_ID FROM JHF_ALIVE_ORDER WHERE ORDER_ID IN (
    SELECT ORDER_ID FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110419WL0000206121') )
) 
SELECT * FROM JHF_ALIVE_CONTRACT_BIND WHERE EXECUTION_ID='20110419CUEX00090310';


SELECT * FROM JHF_UNREALIZED_CASHFLOW WHERE CASHFLOW_SOURCE_ID IN (
    SELECT EXECUTION_ID FROM JHF_ALIVE_EXECUTION WHERE ORDER_ID IN (
    SELECT ORDER_ID FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110418WL0000205832'  ));



;



--====================================================================================

 ---  [ CORRECT ]  CLOSE

SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110414WL0000204773';
 //TRADE TYPE = 1 
SELECT * FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110414WL0000204773'
SELECT * FROM JHF_WL_ORDER_BIND ORDER BY INPUT_DATE DESC LIMIT 3;

SELECT * FROM JHF_HEDGE_CUSTTRADE WHERE ID= '20110126WL0000050606';

SELECT * FROM JHF_SYS_POSITION_INSERT WHERE POSITION_SOURCE_ID ='20110126WL0000050606'

                  ---  选中 JHF_ALIVE_ORDER
SELECT * FROM JHF_ALIVE_ORDER WHERE ORDER_ID = '20110126ORD00136218' ;

SELECT * FROM JHF_ALIVE_CONTRACT WHERE CONTRACT_ID =(
    SELECT SETTLE_CONTRACT_ID FROM JHF_ALIVE_ORDER WHERE ORDER_ID = '20110126ORD00136218' )


SELECT * FROM JHF_ALIVE_EXECUTION WHERE EXECUTION_ID = '20110126CUEX00061518' ;

SELECT * FROM JHF_ALIVE_CONTRACT_BIND WHERE EXECUTION_ID = (SELECT EXECUTION_ID FROM JHF_ALIVE_EXECUTION WHERE EXECUTION_ID = '20110126CUEX00061518' );

SELECT * FROM JHF_UNREALIZED_CASHFLOW WHERE CASHFLOW_SOURCE_ID IN (SELECT EXECUTION_ID FROM JHF_ALIVE_EXECUTION WHERE EXECUTION_ID = '20110126CUEX00061518')



--@@ 
SELECT * FROM JHF_WL_ORDER WHERE COMPLETION_STATUS = 6 ;
UPDATE JHF_WL_ORDER SET COMPLETION_STATUS =5 WHERE COMPLETION_STATUS = 6 ;





 ---  [ CORRECT ]  OPEN

SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110127WL0000050607';
 //TRADE TYPE = 0 
SELECT * FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID = '20110127WL0000050607'

SELECT * FROM JHF_HEDGE_CUSTTRADE WHERE ID= '20110127WL0000050607';

SELECT * FROM JHF_SYS_POSITION_INSERT WHERE POSITION_SOURCE_ID ='20110127WL0000050607'

                  ---  选中 JHF_ALIVE_ORDER
SELECT * FROM JHF_ALIVE_ORDER WHERE ORDER_ID = '20110127ORD00136301' ;

SELECT * FROM JHF_ALIVE_CONTRACT WHERE ORDER_ID = '20110127ORD00136301' ;


SELECT * FROM JHF_ALIVE_EXECUTION WHERE ORDER_ID = '20110127ORD00136301' ;

    ---  决计的注文
    SELECT * FROM JHF_ALIVE_ORDER WHERE SETTLE_CONTRACT_ID = '20110127CONT00050001'

   SELECT * FROM JHF_ALIVE_CONTRACT_BIND WHERE CONTRACT_ID IN (SELECT CONTRACT_ID FROM JHF_ALIVE_CONTRACT WHERE ORDER_ID = '20110127ORD00136301')
   
   SELECT * FROM JHF_UNREALIZED_CASHFLOW WHERE CASHFLOW_SOURCE_ID IN (
        SELECT EXECUTION_ID FROM JHF_ALIVE_CONTRACT_BIND WHERE CONTRACT_ID IN (SELECT CONTRACT_ID FROM JHF_ALIVE_CONTRACT_BIND WHERE CONTRACT_ID IN (SELECT CONTRACT_ID FROM JHF_ALIVE_CONTRACT WHERE ORDER_ID = '20110127ORD00136301')));

--SELECT * FROM JHF_ALIVE_ORDER WHERE SETTLE_CONTRACT_ID = '20110127CONT00050001'
--====================


//   REPAIR COMPLETOR STATUS 

UPDATE JHF_WL_ORDER SET COMPLETION_STATUS = 3 where CLIENT_ID = 'WLXXXX' and CURRENCY_PAIR = 'EUR/JPY' ;
UPDATE JHF_WL_ORDER SET  COMPLETION_STATUS = 5 where WL_ORDER_ID= '20110126WL0000050401' ;





// TRADER  RISK 

SELECT * FROM JHF_CASH_BALANCE WHERE CUSTOMER_ID = '98000001' ;
UPDATE JHF_CASH_BALANCE  SET CASH_BALANCE = '-999999999999' WHERE CUSTOMER_ID = '98000001'  ;
UPDATE JHF_CASH_BALANCE  SET CASH_BALANCE = '999999' WHERE CUSTOMER_ID = '98000001'  ;



SELECT * FROM JHF_WL_CLIENT_CONFIG WHERE CLIENT_ID = 'WLXXXX' ;
SELECT CONTRACT_UPPER_AMOUNT FROM JHF_WL_STATUS_CONTRAL WHERE CLIENT_ID = 'WLXXXX' AND CURRENCY_PAIR = 'USD/JPY'
--UPDATE JHF_WL_STATUS_CONTRAL SET CONTRACT_UPPER_AMOUNT = 1000000 WHERE CLIENT_ID = 'WLXXXX' AND CURRENCY_PAIR = 'USD/JPY'

SELECT * FROM JHF_APPLICATION_DATE
SELECT * FROM JHF_WL_SYS_POSITION WHERE CLIENT_ID = 'WLXXXX' AND CURRENCY_PAIR = 'USD/JPY' AND BASE_DATE = '20110210'

--UPDATE JHF_WL_SYS_POSITION SET BASE_DATE = '20110209' WHERE BASE_DATE = '20110113' AND CLIENT_ID = 'WLXXXX' AND CURRENCY_PAIR = 'USD/JPY'
--UPDATE JHF_WL_SYS_POSITION SET BASE_DATE = '20110210' ,AMOUNT = '130000' WHERE  BASE_DATE = '20110210' AND CLIENT_ID = 'WLXXXX' AND CURRENCY_PAIR = 'USD/JPY'

SELECT CLIENT_ID,CURRENCY_PAIR,SUM(SIDE * ORDER_AMOUNT),ORDER_DATE FROM JHF_WL_ORDER 
WHERE ORDER_DATE = '20110211' AND ORDER_STATUS = 2  AND ACTIVE_FLAG = 1  GROUP BY CLIENT_ID,CURRENCY_PAIR ;

--UPDATE JHF_WL_ORDER set ORDER_DATE = '20110211' WHERE ORDER_DATE = '20110214'




SELECT SIDE,ORDER_AMOUNT FROM JHF_WL_ORDER  WHERE ORDER_STATUS = 2  AND ORDER_DATE = '20110211' ;
SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID='20110211WL0000051210'




show create table JHF_ALIVE_ORDER;
SELECT * FROM JHF_APPLICATION_DATE

UPDATE JHF_WL_ORDER SET COMPLETION_STATUS = 5 ,ORDER_DATE='20110127' WHERE WL_ORDER_ID = '20110126WL0000050528'

SELECT * FROM JHF_SYS_POSITION_INSERT WHERE POSITION_SOURCE_ID='20110126WL0000050528'


;
SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110126WL0000050528'
UPDATE JHF_WL_ORDER SET COMPLETION_STATUS = 3 WHERE ORDER_DATE <> '20110127' AND COMPLETION_STATUS <> 3;
UPDATE JHF_WL_ORDER SET COMPLETION_STATUS = 3 WHERE WL_ORDER_ID = '20110126WL0000050528'
SELECT * FROM JHF_WL_ORDER WHERE ORDER_DATE <> '20110127' AND COMPLETION_STATUS <> 3;

SELECT * FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID='20110127WL0000050607' 



-- WL 
SELECT SETTLE_CONTRACT_ID ,EXECUTION_PRICE FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID = '98000001' AND CUSTOMER_ORDER_NO = 'T000006964'

SELECT ORDER_ID,CONTRACT_ID, EXECUTION_PRICE FROM JHF_ALIVE_CONTRACT WHERE CONTRACT_ID = '20110126CONT00051002'


SELECT CUSTOMER_ORDER_NO FROM JHF_ALIVE_ORDER WHERE ORDER_ID = '20110126ORD00141314';


SELECT * FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID ='98000001' ;


SELECT * FROM JHF_WL_ORDER WHERE CLIENT_ID <> 'WLXXXX'


---  COMPLETOR  FIX 

SELECT * FROM JHF_WL_ORDER WHERE CUSTOMER_ID = '98000101' AND COMPLETION_STATUS = 1 ;
UPDATE JHF_WL_ORDER  SET COMPLETION_STATUS = 3 WHERE CUSTOMER_ID = '98000101' AND COMPLETION_STATUS = 1 ;


---   hiber8 exception test

SELECT * FROM JHF_WL_ORDER WHERE  WL_ORDER_ID = '20110113WL0000017086' ;

SELECT WL_ORDER_ID ,UPDATE_DATE ,REVISION_NUMBER FROM JHF_WL_ORDER WHERE  WL_ORDER_ID = '20110113WL0000017086' ;
UPDATE JHF_WL_ORDER SET REVISION_NUMBER = 100 WHERE WL_ORDER_ID = '20110113WL0000017086' ;
---- something  
SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID IN ( '20110218WL0000019011' )
SELECT ORDER_DATE FROM JHF_WL_ORDER WHERE WL_ORDER_ID IN ( '20110218WL0000019011' ),'20110221WL0000019101') ;
SELECT ORDER_DATE FROM JHF_WL_ORDER WHERE WL_ORDER_ID IN ( '20110218WL0000019011' ,'20110221WL0000019101') ;


SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110215WL0000016601';
UPDATE JHF_WL_ORDER SET INPUT_DATE = '2011-02-21 09:00:00'  WHERE WL_ORDER_ID = '20110218WL0000019011' ;
UPDATE JHF_WL_ORDER SET ORDER_DATE='20110221' ,ORDER_TIME ='' ,ORDER_TI  WHERE WL_ORDER_ID = '20110218WL0000019011' ;

SELECT * FROM JHF_APPLICATION_DATE


SELECT POSITION_SOURCE_FLAG FROM JHF_SYS_POSITION_INSERT WHERE POSITION_SOURCE_ID='20110215WL0000016601' ;

UPDATE JHF_SYS_POSITION_INSERT SET POSITION_SOURCE_FLAG = 3 WHERE POSITION_SOURCE_ID='20110215WL0000016601' ;
UPDATE JHF_WL_ORDER SET COMPLETION_STATUS = 5 WHERE WL_ORDER_ID = '20110215WL0000016601'

SELECT ORDER_STATUS FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110215WL0000016601'

SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110215WL0000016601' ;

SELECT * FROM JHF_HEDGE_CUSTTRADE WHERE AMOUNT_HEDGING < 0
SELECT * FROM JHF_WL_ORDER WHERE COMPLETION_AMOUNT > ORDER_AMOUNT  OR COMPLETION_AMOUNT < 0;


SELECT * FROM JHF_HEDGE_CUSTTRADE WHERE ID = '20110216WL0000016807'

SELECT * FROM JHF_HEDGE_CUSTTRADE_TRIGGER WHERE ID = '20110216WL0000016807'
SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110211WL0000051218'
SELECT * FROM JHF_APPLICATION_DATE
UPDATE JHF_WL_ORDER SET EXECUTION_DATE = '20110302' ,ORDER_DATE = '20110302' ,COMPLETION_STATUS = 1 WHERE WL_ORDER_ID = '20110211WL0000051218' ;

UPDATE JHF_WL_ORDER SET ORDER_DATE = '20110302' ,COMPLETION_STATUS = 1 WHERE COMPLETION_STATUS IN (1,4) ;





---   update orderdate <> frontdate



UPDATE JHF_WL_ORDER SET ORDER_STATUS = 'C' WHERE ORDER_STATUS = 2 AND COMPLETION_STATUS <> 3 AND CLIENT_ID IN( 'WL0004','WL0003','WL0002','WL0001');

SELECT * FROM JHF_WL_SYS_POSITION WHERE BASE_DATE = '20110309' AND CLIENT_ID = 'WL0003' ;







---    ALL CCY   UPPER AMOUNT   CONSTRAINT


SELECT * FROM JHF_WL_CLIENT_CONFIG WHERE  ;
SELECT * FROM JHF_COUNTERPARTY where ACTIVE_FLAG =1 and RUNING_STATUS = 1 and COUNTERPARTY_ID = 'MOCK';
update JHF_COUNTERPARTY set COUNTERPARTY_ID ='WLCM' where COUNTERPARTY_ID = 'MS'
update JHF_COUNTERPARTY set COUNTERPARTY_SHORT_NAME ='WLCM' where COUNTERPARTY_ID = 'WLCM'
SELECT * FROM JHF_COUNTERPARTY_CURRENCYPAIR ;
update JHF_COUNTERPARTY_CURRENCYPAIR set COUNTERPARTY_ID ='WLCM' where COUNTERPARTY_ID = 'MS'
SELECT * FROM JHF_WL_CP_CONTRAL WHERE CLIENT_ID = ''

SELECT * FROM JHF_COUNTERPARTY_CURRENCYPAIR_SET ; 

SELECT * FROM JHF_WL_CP_CONTRAL WHERE CLIENT_ID = 'MINFX' AND COUNTERPARTY_ID

UPDATE JHF_WL_CP_CONTRAL SET COUNTERPARTY_ID = 'WLCM' WHERE CLIENT_ID = 'MINFX' AND COUNTERPARTY_ID = 'MS' ;



SELECT * FROM JHF_WL_RATE_CONFIG 


SELECT * FROM JHF_HEDGER_MODE WHERE COUNTERPARTY_ID = 'MS';

UPDATE JHF_HEDGER_MODE SET COUNTERPARTY_ID='WLCM' WHERE COUNTERPARTY_ID = 'MS';

SELECT * FROM JHF_WL_CLIENT_CONFIG WHERE CLIENT_ID = 'MINFX' ;
SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID = '20110524WL0000001919';


SELECT * FROM JHF_WL_SYS_POSITION WHERE CLIENT_ID = 'MINFX' AND CURRENCY_PAIR = 'USD/JPY'
UPDATE JHF_WL_SYS_POSITION SET AMOUNT = '70000' WHERE AMOUNT = '70002' AND CLIENT_ID = 'MINFX' AND CURRENCY_PAIR = 'USD/JPY'
SELECT * FROM JHF_WL_CLIENT_CONFIG WHERE CLIENT_ID

SELECT CONTRACT_UPPER_AMOUNT FROM JHF_WL_STATUS_CONTRAL WHERE CLIENT_ID = 'MINFX' AND CURRENCY_PAIR ='USD/JPY' ;

UPDATE JHF_WL_STATUS_CONTRAL SET CONTRACT_UPPER_AMOUNT = 1000000 WHERE CLIENT_ID = 'MINFX' AND CURRENCY_PAIR ='USD/JPY' ;

---   买卖相抵

20110314WL0000015454
20110314WL0000015453
新规注文 买：20110314WL0000015451
反方向 卖：20110314WL0000015452

SELECT * FROM JHF_WL_ORDER WHERE WL_ORDER_ID in ( '20110314WL0000015458','');
SELECT * FROM JHF_WL_ORDER_BIND WHERE WL_ORDER_ID in (  '20110314WL0000015458','');  -- 20110314ORD00147206

SELECT ORDER_ID, TRADE_TYPE, TOP_ORDER_ID FROM JHF_ALIVE_ORDER WHERE ORDER_ID = '20110314ORD00147208 ' ;
SELECT *  FROM JHF_ALIVE_CONTRACT WHERE ORDER_ID = '20110314ORD00147223'
SELECT * FROM JHF_ALIVE_CONTRACT WHERE CONTRACT_ID IN (SELECT SETTLE_CONTRACT_ID FROM JHF_ALIVE_ORDER WHERE ORDER_ID = '20110314ORD00147102');
SELECT * FROM JHF_ALIVE_EXECUTION WHERE EXECUTION_ID = '20110314CUEX00070202'




SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '98000004' AND AMOUNT_NO_SETTLED > 0 AND CURRENCY_PAIR = 'AUD/CHF' ORDER BY INPUT_DATE,CONTRACT_ID ASC  ;



SELECT COUNT(*) FROM JHF_WL_ORDER ;


SELECT * FROM JHF_WL_ORDER ;

SELECT * FROM  JHF_APPLICATION_DATE ;


SELECT * FROM JHF_WL_ORDER WHERE ORDER_STATUS = 2 AND COMPLETION_STATUS <> 3 AND CLIENT_ID = 'WL0004';
SELECT * FROM JHF_WL_SYS_POSITION WHERE BASE_DATE = '20110310' AND CLIENT_ID = 'WL0004';


SELECT * FROM JHF_ALIVE_CONTRACT WHERE CONTRACT_ID IN (SELECT SETTLE_CONTRACT_ID FROM JHF_ALIVE_ORDER WHERE ORDER_ID = '20110314ORD00147223');








SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '98000002' AND AMOUNT_NO_SETTLED > 0 AND 

SELECT * FROM JHF_WL_RATE_CONFIG WHERE CLIENT_ID = 'MINFX' AND ACTIVE_FLAG =1 ;

SELECT * FROM JHF_WL_POSITION_AUTO_REBUILD WHERE FRONT_DATE = '20120102' AND CUSTOMER_ID = '98000002' ;

SELECT * FROM JHF_WL_ORDER WHERE CLIENT_ID = 'MINFX' AND ORDER_STATUS =2 AND COMPLETION_STATUS <>3 





-----   WL    STAY4
select * from JHF_APPLICATION_DATE

SELECT * FROM JHF_GROUP_PRODUCT_BAND WHERE GROUP_ID = 'DEFAULT'

SELECT GROUP_ID FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID = '00006701'
UPDATE JHF_CUSTOMER_STATUS SET GROUP_ID='A_Corporation' WHERE CUSTOMER_ID = '00006701'

SELECT * FROM JHF_HEDGE_CUSTTRADE WHERE ID = '20110906CUEX00032514'

SELECT * FROM JHF_WL_RATE_CONFIG WHERE CLIENT_ID = 'MINFX' and CURRENCY_PAIR = 'EUR/JPY'

UPDATE JHF_WL_RATE_CONFIG SET 
BD1_LOWER_AMOUNT = 10000 ,BD1_UPPER_AMOUNT = 3000000 ,
BD2_LOWER_AMOUNT = 10000 ,BD2_UPPER_AMOUNT = 3000000 ,
BD3_LOWER_AMOUNT = 10000 ,BD3_UPPER_AMOUNT = 3000000 ,
BD4_LOWER_AMOUNT = 10000 ,BD4_UPPER_AMOUNT = 3000000 WHERE CLIENT_ID = 'MINFX';

SELECT TRADABLE_END_INTERVAL FROM JHF_WL_CLIENT_CONFIG where CLIENT_ID = 'MINFX';
SELECT FEED_DIV FROM JHF_WL_RATE_CONFIG where CLIENT_ID = 'MINFX' and CURRENCY_PAIR = 'EUR/JPY';

SELECT TRADABLE_END_INTERVAL FROM JHF_WL_CLIENT_CONFIG where CLIENT_ID = 'MINFX';
UPDATE JHF_WL_CLIENT_CONFIG SET TRADABLE_END_INTERVAL = -999999999  where CLIENT_ID = 'MINFX'; 
UPDATE JHF_WL_CLIENT_CONFIG SET TRADABLE_END_INTERVAL = 300000  where CLIENT_ID = 'MINFX'; 


;



SELECT * FROM JHF_WL_ORDER WHERE CUSTOMER_ID IN ('98000201') and COMPLETION_STATUS <> 3;
update JHF_WL_ORDER set COMPLETION_STATUS =3 WHERE CUSTOMER_ID IN ('98000201')


SELECT * FROM JHF_ALIVE_CONTRACT 
WHERE CUSTOMER_ID IN ('98000002') AND  AMOUNT_NO_SETTLED > 0 AND FORCE_RELATION_FLAG = 0 AND ACTIVE_FLAG =1;

SELECT * FROM JHF_WL_CLIENT_CONFIG 

SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '98000002' AND AMOUNT_NO_SETTLED > 0 
SELECT SUM(SIDE * AMOUNT_NO_SETTLED) FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '98000002' AND AMOUNT_NO_SETTLED > 0 GROUP BY CURRENCY_PAIR


SELECT * FROM JHF_TRADE_CONSTRAINT ;


