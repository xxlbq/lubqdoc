
--  关闭 losscut riskcontrol 开关
--  admin 修改
--  检查  forcecut 模块 是否运行正常

-- 检查追证开关
SELECT * FROM JHF_APP_PROPERTY where PROPERTY_KEY = 'FORCECUTFLAG' ;
UPDATE JHF_APP_PROPERTY SET   PROPERTY_VALUE = 0 WHERE PROPERTY_KEY = 'FORCECUTFLAG'


-- 修改改顾客的balance ，达到追证线一下
UPDATE JHF_CASH_BALANCE SET CASH_BALANCE = '180000000' WHERE CUSTOMER_ID = '00000120';
UPDATE JHF_CASH_BALANCE SET CASH_BALANCE = '-180000000' WHERE CUSTOMER_ID = '00000120';

------------------------------
------ 追证  ROLLOVER
-------------------------------
SELECT * FROM JHF_TRADE_CONSTRAINT


①--关闭市场
UPDATE JHF_TRADE_CONSTRAINT SET MARKET_CLOSE_FLAG =1 ,MCUT_COMPUTE_CONSTRAINT =0 ;
②--发送 cleardao  clearFormula
--修改 margincut可计算 flag

--open市场
UPDATE JHF_TRADE_CONSTRAINT SET MARKET_CLOSE_FLAG =0,MCUT_COMPUTE_CONSTRAINT =0 ;

SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID ='' ;

//  FRONT  交易限制
SELECT * FROM JHF_TRADE_CONSTRAINT;
UPDATE JHF_TRADE_CONSTRAINT SET MARKET_CLOSE_FLAG = 0,OPEN_BUY_CONSTRAINT =0 , OPEN_SELL_CONSTRAINT =0,    CLOSE_BUY_CONSTRAINT =0,    CLOSE_SELL_CONSTRAINT = 0 ,MCUT_COMPUTE_CONSTRAINT = 0  

------------------------------
-- 修改 front date
------------------------------
SELECT * FROM JHF_APPLICATION_DATE;

-- before the day

/*  @@@@@@@@     PAY  A  BIG  ATTENTION TO   (  JHF_ALIVE_CONTRACT    DAILY SETTLE OR   SETTLE   !!!!!!!!!!  )*/

UPDATE  JHF_APPLICATION_DATE SET FRONT_DATE='20120313' WHERE DATE_KEY='B';
UPDATE  JHF_APPLICATION_DATE SET FRONT_DATE='20120314' WHERE DATE_KEY='F'; 
UPDATE  JHF_APPLICATION_DATE SET FRONT_DATE='20120314' WHERE DATE_KEY='S';


UPDATE  JHF_APPLICATION_DATE SET FRONT_DATE='20120314' WHERE DATE_KEY='B';
UPDATE  JHF_APPLICATION_DATE SET FRONT_DATE='20120315' WHERE DATE_KEY='F'; 
UPDATE  JHF_APPLICATION_DATE SET FRONT_DATE='20120315' WHERE DATE_KEY='S';





UPDATE  JHF_APPLICATION_DATE SET FRONT_END_DATETIME = '2011-12-09 05:50:00' ;




---  MARGIN DEFICIENT
--DELETE FROM JHF_MARGIN_DEFICIENT_INFO WHERE MARGIN_DEFICIENT_ID ='MD00044002';
SELECT MARGIN_DEFICIENT_ID FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID = '00003101'
SELECT OPEN_BUY_CONSTRAINT,OPEN_SELL_CONSTRAINT ,WITHDRAWAL_CONSTRAINT  FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID = '00003101' ;
UPDATE JHF_CUSTOMER_STATUS SET LOGIN_CONSTRAINT =0,LOSSCUT_CONSTRANT =1   WHERE  CUSTOMER_ID = '00003101'


SELECT * FROM JHF_APPLICATION_DATE ;
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO WHERE MARGIN_DEFICIENT_ID ='MD00044002';
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO WHERE FRONT_DATE ='20100901'
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID  IN ( '', '00094051','') and FRONT_DATE='20111123';
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO_TRIGGER WHERE CUSTOMER_ID  IN ( '00094051','');
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO_TRIGGER WHERE CUSTOMER_ID  IN ( '00094051');
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO_TRIGGER WHERE MARGIN_DEFICIENT_ID = 'MD00002002';
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID = '00000120' AND FRONT_DATE = '20100830' AND MARGIN_DEFICIENT_STATUS <> 0;
SELECT CUSTOMER_ID,MARGIN_DEFICIENT_ID, FRONT_DATE,WITHDRAWAL_CANCLE_AMOUNT FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID = '00093692';



-- 删除 JHF_MARGIN_DEFICIENT_INFO  记录

DELETE FROM JHF_MARGIN_DEFICIENT_INFO WHERE  CUSTOMER_ID = '00000120' 
DELETE FROM JHF_MARGIN_DEFICIENT_INFO WHERE  MARGIN_DEFICIENT_ID IN( 'MD00009506','' );

----  TRIGGER 

SELECT * FROM JHF_MARGIN_DEFICIENT_INFO_TRIGGER WHERE MARGIN_DEFICIENT_ID = 'MD00001002'
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO_TRIGGER WHERE CUSTOMER_ID = '00093692'
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID = '00000120'



UPDATE JHF_MARGIN_DEFICIENT_INFO SET  FRONT_DATE = '20120213'  WHERE  CUSTOMER_ID = '00000120';
UPDATE JHF_MARGIN_DEFICIENT_INFO SET  MARGIN_DEFICIENT_STATUS = 1 WHERE  CUSTOMER_ID = '00000101'
UPDATE JHF_MARGIN_DEFICIENT_INFO SET  FRONT_DATE = '20110421' WHERE  CUSTOMER_ID = '00000120'
UPDATE JHF_MARGIN_DEFICIENT_INFO SET  DEPOSIT_AMOUNT = 0 WHERE  CUSTOMER_ID = '00000101' 
UPDATE JHF_MARGIN_DEFICIENT_INFO SET  CUSTOMER_ID = '00078662',MARGIN_DEFICIENT_STATUS = 1,FRONT_DATE='20110420'  WHERE  MARGIN_DEFICIENT_ID = 'MD00003004' 
UPDATE JHF_MARGIN_DEFICIENT_INFO SET MARGIN_DEFICIENT_STATUS = 1,OPEN_BUY_CONSTRAINT =3,OPEN_SELL_CONSTRAINT =3,WITHDRAWAL_CONSTRAINT =1 WHERE CUSTOMER_ID = '00093381';
UPDATE JHF_MARGIN_DEFICIENT_INFO SET FRONT_DATE = '20110420',MARGIN_DEFICIENT_STATUS = 1 WHERE CUSTOMER_ID = '00000120';

UPDATE JHF_CUSTOMER_STATUS SET MARGIN_DEFICIENT_ID = 'MD00003007' WHERE CUSTOMER_ID = '00000120' ;

SELECT CUSTOMER_ID ,MARGIN_DEFICIENT_ID,OPEN_BUY_CONSTRAINT,OPEN_SELL_CONSTRAINT,WITHDRAWAL_CONSTRAINT 
FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID = '70074054';

SELECT *  FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID = '00000014';


SELECT * FROM JHF_TRADE_CONSTRAINT

--+ =========================
---  QUEERY   CONTRACT 

SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID in ('00093981' ,'00093977', '00093975') AND AMOUNT_NO_SETTLED > 0 ;

--+===========================
SELECT * FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID = '00006701'
UPDATE JHF_CUSTOMER_STATUS SET OPEN_BUY_CONSTRAINT =0,OPEN_SELL_CONSTRAINT =0,WITHDRAWAL_CONSTRAINT =0 WHERE CUSTOMER_ID = '00093381';
UPDATE JHF_CUSTOMER_STATUS SET OPEN_BUY_CONSTRAINT =3,OPEN_SELL_CONSTRAINT =3,WITHDRAWAL_CONSTRAINT =1 WHERE CUSTOMER_ID = '00093381';
UPDATE JHF_CUSTOMER_STATUS SET  MARGIN_DEFICIENT_ID='999999998' WHERE CUSTOMER_ID = '00006701'
 --  INFO   JHF_MARGIN_ACCOUNT
SELECT * FROM JHF_MARGIN_ACCOUNT WHERE CUSTOMER_ID = '00000101';
UPDATE JHF_MARGIN_ACCOUNT SET ACCOUNT_STATUS = 0 ,ACCOUNT_MARGIN = 0 WHERE CUSTOMER_ID = '00000101';
UPDATE JHF_MARGIN_ACCOUNT SET MARGIN_DEFICIENT_STATUS = 0 WHERE CUSTOMER_ID = '00000101';

SELECT * FROM JHF_DEPOSIT WHERE CUSTOMER_ID = '70065939' ORDER BY INPUT_DATE DESC;


SHOW CREATE TABLE JHF_MARGIN_DEFICIENT_INFO ;
DELETE FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID = '70065904' ;
DELETE FROM JHF_MARGIN_DEFICIENT_INFO WHERE MARGIN_DEFICIENT_ID= 'MD00004006';
                    --- FOR FRONT 
INSERT INTO JHF_MARGIN_DEFICIENT_INFO(MARGIN_DEFICIENT_ID, CUSTOMER_ID, FRONT_DATE, HAPPEN_DATETIME, CHANGE_ROUTE,MARGIN_DEFICIENT_STATUS, PURE_MARGIN_BALANCE, POSITION_MARGIN, POSITION_MARGIN_CHANGE, MARGIN_DEFICIENT, MARGIN_DEFICIENT_CHASE, DEPOSIT_AMOUNT, WITHDRAWAL_CANCLE_AMOUNT, WITHDRAWAL_CONSTRAINT, OPEN_BUY_CONSTRAINT, OPEN_SELL_CONSTRAINT, UPDATE_STAFF_ID, INPUT_STAFF_ID, ACTIVE_FLAG, INPUT_DATE, UPDATE_DATE) 
    VALUES('999999998', '00000101', '20100510', CURRENT_TIMESTAMP, 0,1, 0, 0, 0, -987654321,0, 0, 0, 0, 0, 0, '', '', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
;
                     --- FOR   BATCH REPORT
INSERT INTO JHF_MARGIN_DEFICIENT_INFO(MARGIN_DEFICIENT_ID, CUSTOMER_ID, FRONT_DATE, HAPPEN_DATETIME, CHANGE_ROUTE,MARGIN_DEFICIENT_STATUS, PURE_MARGIN_BALANCE, POSITION_MARGIN, POSITION_MARGIN_CHANGE, MARGIN_DEFICIENT, MARGIN_DEFICIENT_CHASE, DEPOSIT_AMOUNT, WITHDRAWAL_CANCLE_AMOUNT, WITHDRAWAL_CONSTRAINT, OPEN_BUY_CONSTRAINT, OPEN_SELL_CONSTRAINT, UPDATE_STAFF_ID, INPUT_STAFF_ID, ACTIVE_FLAG, INPUT_DATE, UPDATE_DATE) 
    VALUES('999999998', '00000101', '20100601', CURRENT_TIMESTAMP, 0,1, 0, 0, 0, -123456,0, 0, 0, 0, 0, 0, '', '', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
;


UPDATE JHF_MARGIN_ACCOUNT SET MARGIN_DEFICIENT_STATUS = 3 WHERE CUSTOMER_ID = '00000101';
UPDATE JHF_MARGIN_DEFICIENT_INFO SET MARGIN_DEFICIENT_STATUS = 3 WHERE CUSTOMER_ID = '00000101'



UPDATE JHF_MARGIN_DEFICIENT_INFO SET MARGIN_DEFICIENT ='-66666666666' WHERE CUSTOMER_ID = '00000101' AND FRONT_DATE = '20100510' ;

UPDATE JHF_MARGIN_DEFICIENT_INFO SET MARGIN_DEFICIENT_CHASE = '0',MARGIN_DEFICIENT ='100000' WHERE CUSTOMER_ID = '00000101' AND FRONT_DATE = '20100510' ;
UPDATE JHF_MARGIN_DEFICIENT_INFO SET MARGIN_DEFICIENT_CHASE = '0',MARGIN_DEFICIENT ='-66666666666' WHERE CUSTOMER_ID = '00000101' AND FRONT_DATE = '20100510' ;
UPDATE JHF_MARGIN_DEFICIENT_INFO SET MARGIN_DEFICIENT_STATUS = 3 WHERE CUSTOMER_ID = '00000101' AND FRONT_DATE = '20100510' ;


                     ----  QUERY  CUSTOMER NOW DEFICIENT 
SELECT sql_no_cache (MARGIN_DEFICIENT + DEPOSIT_AMOUNT + WITHDRAWAL_CANCLE_AMOUNT + POSITION_MARGIN_CHANGE ) AS NOW_DEFICIENT 
FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID = '00000101' AND FRONT_DATE = '20100510';

SELECT CUSTOMER_ID,MARGIN_DEFICIENT , POSITION_MARGIN_CHANGE , DEPOSIT_AMOUNT , WITHDRAWAL_CANCLE_AMOUNT 
FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID = '00000101' AND FRONT_DATE = '20100510';


SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '00093989' AND AMOUNT_NO_SETTLED > 0
SELECT * FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID = '00000239'

DELETE FROM JHF_MARGIN_DEFICIENT_INFO WHERE MARGIN_DEFICIENT_ID='MD00000003'
SELECT * FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID = '00000239'

 --   JHF_APPLICATION_DATE  
SELECT * FROM JHF_APPLICATION_DATE;
UPDATE JHF_CUSTOMER_STATUS SET MARGIN_DEFICIENT_ID = null  WHERE CUSTOMER_ID = '00000239'

-- OTHER TEST   CUSTOMER TMEP
INSERT INTO JHF_MARGIN_DEFICIENT_INFO(MARGIN_DEFICIENT_ID, CUSTOMER_ID, FRONT_DATE, HAPPEN_DATETIME, CHANGE_ROUTE, PURE_MARGIN_BALANCE, POSITION_MARGIN, POSITION_MARGIN_CHANGE, MARGIN_DEFICIENT, MARGIN_DEFICIENT_CHASE, DEPOSIT_AMOUNT, WITHDRAWAL_CANCLE_AMOUNT, WITHDRAWAL_CONSTRAINT, OPEN_BUY_CONSTRAINT, OPEN_SELL_CONSTRAINT, UPDATE_STAFF_ID, INPUT_STAFF_ID, ACTIVE_FLAG, INPUT_DATE, UPDATE_DATE) 
    VALUES('888888888', '00000202', '20100510', CURRENT_TIMESTAMP, 0, 0, 0, 0, 0,-123456, 0, 0, 0, 0, 0, '', '', 1, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
;




SELECT MARGIN_DEFICIENT_CHASE,DEPOSIT_AMOUNT,POSITION_MARGIN FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID='00000101' FOR UPDATE;




SELECT * FROM JHF_MARGIN_ACCOUNT WHERE CUSTOMER_ID = '00000101';

UPDATE JHF_MARGIN_ACCOUNT SET MARGIN_DEFICIENT_STATUS = 1 WHERE CUSTOMER_ID = '00000101';

--- JHF_APP_PROPERTY 
SELECT * FROM JHF_APP_PROPERTY WHERE PROP_TYPE = 'SYSTEM' AND PROPERTY_KEY='FORCECUTFLAG' ;
SELECT * FROM JHF_APP_PROPERTY WHERE PROP_TYPE = 'SYSTEM' AND PROPERTY_KEY='USEALERTRATIO';


UPDATE JHF_APP_PROPERTY SET PROPERTY_VALUE = 0 WHERE  PROP_TYPE = 'SYSTEM' AND PROPERTY_KEY='FORCECUTFLAG' ;
         ----     FORCECUTFLAG    HIDDENT
DELETE FROM JHF_APP_PROPERTY WHERE PROP_TYPE='SYSTEM' AND PROPERTY_KEY='FORCECUTFLAG';
INSERT INTO JHF_APP_PROPERTY (PROP_TYPE,PROPERTY_KEY,PROPERTY_VALUE,DISPLAY_NAME,NOTE,UPDATE_STAFF_ID,INPUT_STAFF_ID,ACTIVE_FLAG,INPUT_DATE,UPDATE_DATE)
VALUES ('SYSTEM','FORCECUTFLAG','1','0:DISPLAY;1:HIDDEN',NULL,'SYSTEM','SYSTEM',1,NOW(),NOW());



         ----     USEALERTRATIO  
DELETE FROM JHF_APP_PROPERTY WHERE PROP_TYPE='SYSTEM' AND PROPERTY_KEY='USEALERTRATIO';
INSERT INTO JHF_APP_PROPERTY (PROP_TYPE,PROPERTY_KEY,PROPERTY_VALUE,DISPLAY_NAME,NOTE,UPDATE_STAFF_ID,INPUT_STAFF_ID,ACTIVE_FLAG,INPUT_DATE,UPDATE_DATE)
VALUES ('SYSTEM','USEALERTRATIO','1','1:USE;0:NOTUSE',NULL,'SYSTEM','SYSTEM',1,NOW(),NOW());

;
;
SELECT * FROM 

UPDATE JHF_APP_PROPERTY SET PROPERTY_VALUE=0 WHERE PROP_TYPE = 'SYSTEM' AND PROPERTY_KEY='FORCECUTFLAG' ;

--  DELETE JHF_ALIVE_CONTRACT
DELETE FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '70065904';


SELECT * FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID='00000101' ORDER BY INPUT_DATE DESC LIMIT 7;




SELECT * FROM UNIQUE_ID_GENERATOR

-- ================================================
--   恢复        JHF_CUSTOMER_STATUS        的状态
-- ================================================
/**  1   **/.
SELECT CUSTOMER_ID ,OPEN_BUY_CONSTRAINT,OPEN_SELL_CONSTRAINT,WITHDRAWAL_CONSTRAINT FROM JHF_CUSTOMER_STATUS 
WHERE CUSTOMER_ID = '00000014';
/**  1   **/.
SELECT CUSTOMER_ID ,OPEN_BUY_CONSTRAINT,OPEN_SELL_CONSTRAINT,WITHDRAWAL_CONSTRAINT,UPDATE_DATE FROM JHF_CUSTOMER_STATUS_TRIGGER  
WHERE CUSTOMER_ID = '00000014' ORDER BY INPUT_DATE  DESC;

SELECT CUSTOMER_ID ,OPEN_BUY_CONSTRAINT,OPEN_SELL_CONSTRAINT,WITHDRAWAL_CONSTRAINT,UPDATE_DATE FROM JHF_CUSTOMER_STATUS
WHERE CUSTOMER_ID = '00093644' ORDER BY INPUT_DATE  DESC;

/**  1   **/.
UPDATE JHF_CUSTOMER_STATUS SET OPEN_BUY_CONSTRAINT =0,OPEN_SELL_CONSTRAINT =0,WITHDRAWAL_CONSTRAINT =0 
WHERE CUSTOMER_ID = '00003101';

/**  1   **/.
UPDATE JHF_CUSTOMER_STATUS SET OPEN_BUY_CONSTRAINT =3,OPEN_SELL_CONSTRAINT =3,WITHDRAWAL_CONSTRAINT =1 
WHERE CUSTOMER_ID = '00000101';



SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID ='70066075' AND AMOUNT_NO_SETTLED > 0 ;




SELECT * FROM JHF_APP_PROPERTY


-- JHF_ALIVE_ORDER
SELECT CUSTOMER_ID,CUSTOMER_ORDER_NO, ORDER_ID,ORDER_STATUS,INPUT_DATE,EXECUTION_TYPE FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID ='00000101'ORDER BY INPUT_DATE desc limit 7 ;

-- JHF_WITHDRAWAL 

SELECT * FROM JHF_WITHDRAWAL WHERE CUSTOMER_ID = '00000120'  ORDER BY INPUT_DATE DESC;
DELETE FROM JHF_WITHDRAWAL WHERE WITHDRAWAL_ID = 'W0000081840';
DELETE FROM JHF_WITHDRAWAL WHERE CUSTOMER_ID = '00000120'
-- JHF_MARGIN_DEFICIENT_INFO
SELECT CUSTOMER_ID,FRONT_DATE ,OPEN_BUY_CONSTRAINT,OPEN_SELL_CONSTRAINT,WITHDRAWAL_CONSTRAINT,ACTIVE_FLAG FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID = '00000101';


-- JHF_MARGIN_ACCOUNT
SELECT * FROM JHF_MARGIN_ACCOUNT WHERE CUSTOMER_ID = '00000101' AND MARGIN_DEFICIENT_STATUS = 1 /*  追证 */ ;

UPDATE JHF_MARGIN_ACCOUNT SET MARGIN_DEFICIENT_STATUS = 1 ,STATUS_TYPE =1  WHERE CUSTOMER_ID = '00000101';
SELECT * FROM JHF_MARGIN_ACCOUNT ;

SELECT PROCESS_ID FROM JHF_MARGIN_ACCOUNT_HISTORY where PROCESS_ID is not null and PROCESS_ID <>'MarginService-0'group by PROCESS_ID;

select * from JHF_MARGIN_DEFICIENT_INFO




SELECT * FROM JHF_APPLICATION_DATE;

-- ===============    ROLLBACK UPDATE  CONSTRAINT        [ROLLOVER FOMULA]     ================

SELECT * FROM JHF_TRADE_CONSTRAINT;
update MCUT_COMPUTE_CONSTRAINT
UPDATE JHF_TRADE_CONSTRAINT SET MARKET_CLOSE_FLAG = 0;
UPDATE JHF_APPLICATION_DATE SET OPEN_TIME = '071000',CLOSE_TIME='065000' WHERE  DATE_KEY = 'B' ;


--  the day
SELECT * FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '00003101' AND AMOUNT_NO_SETTLED > 0

/*
    private static final int ANOTHER_DAY_SETTLE = 1;
    private static final int CURRENT_DAY_SETTLE = 2;
*/

UPDATE JHF_ALIVE_CONTRACT SET SETTLED_TYPE = 1 WHERE CONTRACT_ID = '20110908CONT00032603';

UPDATE  JHF_APPLICATION_DATE SET FRONT_DATE='20110909' WHERE DATE_KEY='F'; 
UPDATE  JHF_APPLICATION_DATE SET FRONT_DATE='20110908' WHERE DATE_KEY='B';
UPDATE  JHF_APPLICATION_DATE SET FRONT_DATE='20110909' WHERE DATE_KEY='S';






---  TRADER  READ   DEFICIENT  CUSTOMER

SELECT * FROM JHF_MARGIN_DEFICIENT_INFO WHERE CUSTOMER_ID = '00000101' AND FRONT_DATE ='20100510' 
AND (MARGIN_DEFICIENT + DEPOSIT_AMOUNT + POSITION_MARGIN_CHANGE + WITHDRAWAL_CANCLE_AMOUNT ) < 0  AND ACTIVE_FLAG = 1 ;


UPDATE JHF_MARGIN_DEFICIENT_INFO SET DEPOSIT_AMOUNT = DEPOSIT_AMOUNT + (380000000) WHERE CUSTOMER_ID = '70074054'

DELETE FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '00000239' ;
---  出金预约取消

SELECT * FROM JHF_WITHDRAWAL WHERE CUSTOMER_ID ='00093644'

---  ID  GENER 

INSERT INTO UNIQUE_ID_GENERATOR(CONTEXT_ID, COUNTER_LENGTH, PREFIX_DATE_FLAG, PREFIX_CONTEXT_ID_FLAG, FETCH_SIZE, CURRENT_COUNT, START_COUNT, CONTEXT_NAME, MAX_COUNT, ACTIVE_FLAG, INPUT_DATE, UPDATE_DATE) 
    VALUES('MD', 8, 0, 1, 500, 1, 1, 'JHF_MARGIN_DEFICIENT_INFO.MARGIN_DEFICIENT_ID', 999999999999999999, 1,CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);
;
DELETE FROM UNIQUE_ID_GENERATOR WHERE CONTEXT_ID='MD';
SELECT * FROM UNIQUE_ID_GENERATOR WHERE CONTEXT_ID = 'MD'


---------------   MAIL    

SELECT * FROM JHF_MAIL_ACTION WHERE MAIL_ACTION_ID = '8500';
SELECT * FROM JHF_MAIL_ACTION WHERE MAIL_ACTION_ID = '8501';


------------------   HISTORY


SELECT * FROM JHF_MARGIN_DEFICIENT_INFO_TRIGGER WHERE MARGIN_DEFICIENT_ID = 'MD00020072'



SELECT ORDER_ID,ORDER_STATUS,ORDER_ROUTE,EXECUTION_TYPE, CHANNEL_ID,CHANGE_REASON,ROUTE_CHANNEL_ID,ORDER_AMOUNT FROM JHF_ALIVE_ORDER 
WHERE CUSTOMER_ID = '00000101' ORDER BY INPUT_DATE DESC LIMIT 5;


SELECT * FROM JHF_APP_PROPERTY
UPDATE  JHF_APP_PROPERTY SET PROPERTY_VALUE ='http://10.4.9.230:8080/margincut/' WHERE PROP_TYPE= 'MARGINCUT_URL' AND PROPERTY_KEY = 'url2' 



--  追证  注文


SELECT * FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID = '00000101' AND EXECUTION_TYPE = 20 ORDER BY INPUT_DATE DESC LIMIT 5;

SELECT ORDER_ID,CUSTOMER_ID,CUSTOMER_ORDER_NO,EXECUTION_TYPE,PRICE_ID FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID = '00000101'  ORDER BY INPUT_DATE DESC LIMIT 1;

SELECT ORDER_ID,CUSTOMER_ID,CUSTOMER_ORDER_NO,EXECUTION_TYPE,PRICE_ID FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID = '00000101' AND CUSTOMER_ORDER_NO = 'T000043906'



SELECT * FROM JHF_TRADE_CONSTRAINT
SELECT * FROM JHF_CUSTOMER_STATUS WHERE CUSTOMER_ID = '00006701'
SELECT * FROM JHF_CUSTOMER_STATUS WHERE LOGIN_ID = 'Vir65956 ' ;
UPDATE JHF_CUSTOMER_STATUS SET LOGIN_PASSWORD = '593c9b4a9390551d53e5cacf28ebd638' WHERE CUSTOMER_ID = '70065893 ' ;





-----    COMPLETOR   DOING 

SELECT ORDER_DATE FROM JHF_WL_ORDER WHERE ORDER_DATE < '20110414' AND ORDER_STATUS =2 AND COMPLETION_STATUS =1 AND CUSTOMER_ID = '98000101'

UPDATE JHF_WL_ORDER SET ORDER_DATE = '20110414' WHERE  ORDER_DATE < '20110414' AND ORDER_STATUS =2 AND COMPLETION_STATUS =1 AND CUSTOMER_ID = '98000101'


---   汇率过期
UPDATE JHF_
ratecacheexpiredtime

SELECT ORDER_ID,ORDER_BIND_ID FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID = '00000048' AND CUSTOMER_ORDER_NO = 'T000000174' ;
SELECT * FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID = '00000239' AND ORDER_STATUS IN (1,7)  ;
DELETE FROM JHF_ALIVE_ORDER WHERE CUSTOMER_ID = '00000239' AND ORDER_STATUS IN (1,7)  ;

DELETE FROM JHF_ALIVE_CONTRACT WHERE CUSTOMER_ID = '00000239' AND AMOUNT_SETTLING > 0 ;


@@@@@@@@@@@  2012 10 10  @@@@@@@@@@@@@

SELECT * FROM JHF_MARGIN_DEFICIENT_INFO;
SELECT * FROM JHF_MARGIN_DEFICIENT_INSERT;

SELECT sql_no_cache        
 MINFO.MARGIN_DEFICIENT           DEFICIENT  ,  
 MINFO.DEPOSIT_AMOUNT  		    DEPOSIT  , 
 MINFO.WITHDRAWAL_CANCLE_AMOUNT   WITHDRAWAL_CANCLE  ,
 MINFO.POSITION_MARGIN_CHANGE     POSITION_CHANGE , 
 MINFO.MARGIN_DEFICIENT_STATUS    DEFICIENT_STATUS    ,
SUM(MINSERT.POSITION_MARGIN_CHANGE)  POSITION_CHANGE_SUM

FROM JHF_MARGIN_DEFICIENT_INFO MINFO  
LEFT JOIN JHF_MARGIN_DEFICIENT_INSERT MINSERT ON MINFO.CUSTOMER_ID=MINSERT.CUSTOMER_ID  AND MINFO.FRONT_DATE = MINSERT.FRONT_DATE  
WHERE MINFO.CUSTOMER_ID=''
 AND MINFO.FRONT_DATE='' 
 AND MINFO.MARGIN_DEFICIENT_STATUS = 1 
 AND MINFO.ACTIVE_FLAG=1   



















